function plotAvg( data )
%plotAvg Problem 6 - Plot average pixel density

    CementedPre = [];
    CementedPost = [];
    UncementedPre = [];
    UncementedPost = [];
    
    for i = 1:length(data.patients)
        patient = data.patients(i);
        patient.group
        
        if strcmp(patient.group, 'cemented')
            for ii = 1:length(patient.preData)
                CementedPre(ii) = patient.preData(ii,4);
            end
            for ii = 1:length(patient.postData)
                CementedPost(ii) = patient.postData(ii,4);
            end
        else 
            for ii = 1:length(patient.preData)
                UncementedPre(ii) = patient.preData(ii,4);
            end
            for ii = 1:length(patient.postData)
                UncementedPost(ii) = patient.postData(ii,4);
            end
        end
        
    end
    
    N = [];
    
    Ncounter = 1;
    
    CementedPre = sumAveragePixels(CementedPre)
    CementedPost = sumAveragePixels(CementedPost)
    UncementedPre = sumAveragePixels(UncementedPre)
    UncementedPost = sumAveragePixels(UncementedPost)
    
    figure;
    plot(-150:1:100, CementedPre);
    ylabel('Percentage of pixels []');
    xlabel('Hounsfield units');
    title('Average curve for pre-op cemented')
    subplot(2,2,1);
    hold on
    plot(-150:1:100, CementedPost);
        ylabel('Percentage of pixels []');
    xlabel('Hounsfield units');
    title('Average curve for pre-op cemented')
    subplot(2,2,1);
    plot(-150:1:100, UncementedPre);
        ylabel('Percentage of pixels []');
    xlabel('Hounsfield units');
    title('Average curve for pre-op cemented')
    subplot(2,2,1);
    plot(-150:1:100, UncementedPost);
        ylabel('Percentage of pixels []');
    xlabel('Hounsfield units');
    title('Average curve for pre-op cemented')
    subplot(2,2,1);

end

function sumAveragePixels( arr )

    for i = -150:1:100
        c = 0;
        
        sumAveragePixels
        c = sum((CementedPre >= (i - 1)) & (CementedPre <= i));
        
        N(Ncounter) = c;
        Ncounter = Ncounter + 1;
    end
    
    N = N/sum(N)*100;
    
end
